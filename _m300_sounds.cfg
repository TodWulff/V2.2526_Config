#####################################################################
# 	Preamble
#####################################################################

# Why?  Because, Geekness Factor to the max.

# https://www.youtube.com/watch?v=K9dwqc301-o

# MIDI Files on bitmidi
# https://bitmidi.com/

# Alex Yu's great MIDI to M300 converter
# https://github.com/alexyu132/midi-m300

# Another MIDI to M300 converter
# https://www.layerfused.com/MIDI-M300

#####################################################################
# 	includes
#####################################################################

[include _gcode_songs.cfg]

#####################################################################
# 	prototypes
#####################################################################

[gcode_macro snd_]
gcode:
#	M300 s2800 p300

#####################################################################
# 	Root Printer Events
#####################################################################

[gcode_macro snd_PowerOn]
gcode:
	sng_startup
	# sng_simpons

#####################################################################
# 	Print Event Sounds
#####################################################################

[gcode_macro snd_PrintStart]
gcode:
	sng_mario

[gcode_macro snd_PrintPause]
gcode:
	#sng_cena
	sng_startup

[gcode_macro snd_PrintEnd]
gcode:
	sng_bethovene

[gcode_macro snd_PrintCancel]
gcode:
	# sng_imperialmarch
	sng_bethovene
	
[gcode_macro snd_PrintFail]
gcode:
	# sng_auldlangsyne

[gcode_macro snd_PrintResume]
gcode:
	# sng_auldlangsyne
	sng_startup

#####################################################################
# 	Mesh Event Sounds
#####################################################################

[gcode_macro snd_MeshStart]
gcode:
#	M300 s2800 p300

[gcode_macro snd_MeshEnd]
gcode:
#	M300 s2800 p300

[gcode_macro snd_MeshFail]
gcode:
#	M300 s2800 p300

[gcode_macro snd_MeshStore]
gcode:
#	M300 s2800 p300

#####################################################################
# 	QGL Event Sounds
#####################################################################


#####################################################################
# 	Other PrePrint Event Sounds
#####################################################################


#####################################################################
# 	Other Sounds
#####################################################################


#####################################################################
# 	M300 Core Routines
#####################################################################

# M300 : Play tone. Beeper support, as commonly found on usual LCD
# displays (i.e. RepRapDiscount 2004 Smart Controller, RepRapDiscount
# 12864 Full Graphic). This defines a custom I/O pin and a custom
# GCODE macro.  Usage:
#   M300 [P<ms>] [S<Hz>]
#   P is the tone duration, S the tone frequency.
# The frequency won't be pitch perfect.

#restore low overhead pwm params
[gcode_macro M300done]
gcode:
	SET_PIN PIN=_BEEPER_pin VALUE=0.0 cycle_time=0.024

[gcode_macro M3001]
gcode:
	{% set S = params.S|default(1000)|int %}	# Use a default 1kHz tone if S is omitted.
	{% set P = params.P|default(100)|int %}		# Use a 10ms duration is P is omitted.

	{% if S > 0 %}
		SET_PIN PIN=_BEEPER_pin VALUE=0.5 cycle_time={1.0/(S|float)}
	{% endif %}
	G4 P{P}
#	SET_PIN PIN=_BEEPER_pin VALUE=0.0


[gcode_macro M300]
gcode:
	{% set S = params.S|default(1000)|int %}	# Use a default 1kHz tone if S is omitted.
	{% set P = params.P|default(100)|int %}		# Use a 10ms duration is P is omitted.

	{% if S > 0 %}
		SET_PIN PIN=_BEEPER_pin VALUE=0.5 cycle_time={1.0/(S|float)}
	{% endif %}
	G4 P{P}
	SET_PIN PIN=_BEEPER_pin VALUE=0.0
